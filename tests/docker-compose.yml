# base file -- will not run by itself -- must be extended with either docker-compose.dev.yml or docker-compose.local.yml

version: '3.8'

networks: 
  mock:

services:

  mockin:
    image: hellocoop/mockin:latest
    networks:
      - mock
    ports:
      - '3333:3333'
    environment:
      ISSUER: 'http://mockin:3333'

  app:
    depends_on:
      - mockin
    image: node:18
    build:
      context: ..
    networks: 
      - mock
    volumes:
      - type: bind
        source: ..
        target: /usr/src/app
    working_dir: /usr/src/app
    ports:
      - '8080:8080'
      - '9449:9229'    
    environment:
      HELLO_WALLET: 'http://mockin:3333'
      HELLO_COOKIE_SECRET: '66c71f55568f7b0c3b30cb6a8df9975b5125000caa775240b2e76eb96c43715e'
  
  # playwright:
  #   depends_on:
  #     - mockin
  #   image: mcr.microsoft.com/playwright:v1.40.0-jammy
  #   networks: 
  #     - mock
  #   volumes:
  #     - type: bind 
  #       source: ./
  #       target: /apps
  #   working_dir: /apps
  #   ipc: host
